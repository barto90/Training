<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Check - Azure App Service</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1e1e1e;
            color: #00ff00;
            padding: 2rem;
            margin: 0;
        }
        
        .health-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .health-status {
            background: #2d2d2d;
            border: 2px solid #00ff00;
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .status-good {
            border-color: #00ff00;
            color: #00ff00;
        }
        
        .status-warning {
            border-color: #ffaa00;
            color: #ffaa00;
        }
        
        .status-error {
            border-color: #ff0000;
            color: #ff0000;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            margin: 0.5rem 0;
            padding: 0.5rem;
            background: #3d3d3d;
            border-radius: 5px;
        }
        
        .timestamp {
            text-align: center;
            margin-top: 2rem;
            opacity: 0.7;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .json-output {
            background: #2d2d2d;
            border: 1px solid #555;
            border-radius: 5px;
            padding: 1rem;
            margin-top: 2rem;
            white-space: pre-wrap;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="health-container">
        <h1>🩺 Health Check Status</h1>
        
        <div class="health-status status-good" id="healthStatus">
            <h2>✅ SERVICE HEALTHY</h2>
            <div class="metric">
                <span>Status:</span>
                <span id="status">OK</span>
            </div>
            <div class="metric">
                <span>Response Time:</span>
                <span id="responseTime">45ms</span>
            </div>
            <div class="metric">
                <span>Memory Usage:</span>
                <span id="memoryUsage">234 MB</span>
            </div>
            <div class="metric">
                <span>CPU Usage:</span>
                <span id="cpuUsage">12%</span>
            </div>
            <div class="metric">
                <span>Uptime:</span>
                <span id="uptime">2d 15h 30m</span>
            </div>
            <div class="metric">
                <span>Active Connections:</span>
                <span id="connections">23</span>
            </div>
            <div class="metric">
                <span>Last Restart:</span>
                <span id="lastRestart">2 days ago</span>
            </div>
        </div>
        
        <div class="json-output" id="jsonOutput">
{
  "status": "healthy",
  "timestamp": "2024-01-15T10:30:45.123Z",
  "version": "1.0.0",
  "environment": "production",
  "checks": {
    "database": "connected",
    "redis": "connected",
    "external_apis": "accessible",
    "disk_space": "sufficient",
    "memory": "normal"
  },
  "metrics": {
    "response_time_ms": 45,
    "memory_usage_mb": 234,
    "cpu_usage_percent": 12,
    "active_connections": 23,
    "requests_per_minute": 156
  },
  "details": {
    "app_service_name": "monitored-webapp-demo",
    "instance_id": "web-001",
    "region": "East US",
    "monitoring_enabled": true
  }
}
        </div>
        
        <div class="timestamp">
            <p>Last updated: <span id="timestamp"></span></p>
            <p>Auto-refresh: <span id="countdown">30</span>s</p>
        </div>
    </div>

    <script>
        let countdownValue = 30;
        
        function updateHealthData() {
            const now = new Date();
            document.getElementById('timestamp').textContent = now.toISOString();
            
            // Simulate some variability in metrics
            const responseTime = Math.floor(Math.random() * 100) + 20; // 20-120ms
            const memoryUsage = Math.floor(Math.random() * 100) + 200; // 200-300 MB
            const cpuUsage = Math.floor(Math.random() * 20) + 5; // 5-25%
            const connections = Math.floor(Math.random() * 50) + 10; // 10-60
            
            document.getElementById('responseTime').textContent = `${responseTime}ms`;
            document.getElementById('memoryUsage').textContent = `${memoryUsage} MB`;
            document.getElementById('cpuUsage').textContent = `${cpuUsage}%`;
            document.getElementById('connections').textContent = connections;
            
            // Update JSON output
            const jsonData = {
                status: "healthy",
                timestamp: now.toISOString(),
                version: "1.0.0",
                environment: "production",
                checks: {
                    database: "connected",
                    redis: "connected",
                    external_apis: "accessible",
                    disk_space: "sufficient",
                    memory: "normal"
                },
                metrics: {
                    response_time_ms: responseTime,
                    memory_usage_mb: memoryUsage,
                    cpu_usage_percent: cpuUsage,
                    active_connections: connections,
                    requests_per_minute: Math.floor(Math.random() * 200) + 100
                },
                details: {
                    app_service_name: "monitored-webapp-demo",
                    instance_id: "web-001",
                    region: "East US",
                    monitoring_enabled: true
                }
            };
            
            document.getElementById('jsonOutput').textContent = JSON.stringify(jsonData, null, 2);
            
            // Simulate occasional warnings (5% chance)
            if (Math.random() < 0.05) {
                const healthStatus = document.getElementById('healthStatus');
                healthStatus.className = 'health-status status-warning';
                healthStatus.querySelector('h2').textContent = '⚠️ SERVICE DEGRADED';
                document.getElementById('status').textContent = 'WARNING';
            } else {
                const healthStatus = document.getElementById('healthStatus');
                healthStatus.className = 'health-status status-good';
                healthStatus.querySelector('h2').textContent = '✅ SERVICE HEALTHY';
                document.getElementById('status').textContent = 'OK';
            }
        }
        
        function updateCountdown() {
            document.getElementById('countdown').textContent = countdownValue;
            countdownValue--;
            
            if (countdownValue < 0) {
                countdownValue = 30;
                updateHealthData();
            }
        }
        
        // Initialize
        updateHealthData();
        
        // Update countdown every second
        setInterval(updateCountdown, 1000);
        
        // Update health data every 30 seconds
        setInterval(updateHealthData, 30000);
    </script>
</body>
</html> 